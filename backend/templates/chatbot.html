{% load static %}
<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="{% static 'style/chatbot.css' %}">
  </head>
  <body>
    <h2>Popup Chat Window</h2>

    <button class="open-button" onclick="openForm()">Chat<i class="fa-solid fa-message-bot"></i></button>

    <div class="chat-popup" id="myForm">
      <form action="" class="form-container">
        <h1>Chat</h1>
        <label for="msg"><b>Message</b></label>
        <div id="demo"></div>
        <textarea placeholder="Type message.." id="msg" name="msg" required rows="1" cols="50"></textarea>
        <button type="submit" id="sendData" onclick="sendDataForm(event)" class="btn"> Send</button>
        <button type="button" class="btn cancel" onclick="closeForm()"> Close </button>
      </form>
    </div>

<!-- <script src={% static 'javascript/chatbot.js' %}></script> -->
<script src="https://kit.fontawesome.com/99da979e95.js" crossorigin="anonymous"></script>
<script>
  function openForm() {
    document.getElementById("myForm").style.display = "block";
  }

  function closeForm() {
    document.getElementById("myForm").style.display = "none";
  }

  function sendDataForm(event) {
    console.log(event);
    let data = document.getElementById("msg").value;
    console.log(data);
    event.preventDefault();


    const xhttp = new XMLHttpRequest();
    xhttp.onload = function () {
      // document.getElementById("demo").innerHTML = this.responseText; 
      console.log(this.responseText)
      document.getElementById("demo").innerHTML += JSON.parse(this.responseText)['status'] + "<br>";
    };
    let message = JSON.stringify({'message':data})
    
    xhttp.open("POST", "{% url 'receiveMessage' %}", true);
    xhttp.send(message);
  }
</script>
  </body>
</html>
